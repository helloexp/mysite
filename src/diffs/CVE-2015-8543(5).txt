+++ net/irda/af_irda.c
--- net/irda/af_irda.c
@@ -1086,6 +1086,9 @@ static int irda_create(struct net *net, struct socket *sock, int protocol,
 struct sock *sk;
 struct irda_sock *self;
 
+	if (protocol < 0 || protocol > SK_PROTOCOL_MAX)
+		return -EINVAL;
+
 if (net != &init_net)
 return -EAFNOSUPPORT;
 
