diff --gita/epan/dissectors/packet-sdp.cb/epan/dissectors/packet-sdp.c
index8740f07..42a820c100644(file)
--- a/epan/dissectors/packet-sdp.c
+++ b/epan/dissectors/packet-sdp.c
@@-2627,7+2627,7@@dissect_sdp(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)
     /* Free the remainded hash tables not used */
     /* XXX - more placeholder functionality */
     if (transport_info == &local_transport_info) {
-        for (n = transport_info->media_count; n < SDP_MAX_RTP_CHANNELS; n++)
+        for (n = MAX(transport_info->media_count, 0); n < SDP_MAX_RTP_CHANNELS; n++)
         {
             if (!transport_info->media[n].set_rtp)
             {
