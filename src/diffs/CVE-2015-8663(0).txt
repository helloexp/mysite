diff --gita/libavcodec/utils.cb/libavcodec/utils.c
indexe018e44..d00dfae100644(file)
--- a/libavcodec/utils.c
+++ b/libavcodec/utils.c
@@-888,8+888,10@@end:
 int ff_get_buffer(AVCodecContext *avctx, AVFrame *frame, int flags)
 {
     int ret = get_buffer_internal(avctx, frame, flags);
-    if (ret < 0)
+    if (ret < 0) {
         av_log(avctx, AV_LOG_ERROR, "get_buffer() failed\n");
+        frame->width = frame->height = 0;
+    }
     return ret;
 }
 
