{% extends "reward.html" %} 
{% block siderbar %} 
    list[2].classList.add('active') 
{% endblock %}

{% block rewardContent %}
<h2 class="page-header">Vulnerabilities with incomplete CVE infomation:</h2>

{%if errors%}
    {%for error in errors%}
        <p style="color:red">{{error}}</p>
    {%endfor%}
{%endif%}

<p>There are <strong>{{pageInfo.sum}} </strong> records.</p>
<p>Displaying matches {{pageInfo.curIndex}} through {{pageInfo.endIndex}}.</p>
<div class="table-responsive">
    <table class="table table-striped">
        {%if cves%}
        <thead>
            <tr>
                <th style="width: 15%;">CVE</th>
                <th style="width: 10%;">CWE</th>
                <th style="width: 10%;">CVSS Severity</th>
                <th style="width: 50%;">Summary</th>
                <th style="width: 5%;">Exploits</th>
                <th style="width: 10%;">UpdateTime</th>
                <th>To Reward</th>
            </tr>
        </thead>
        <tbody>
            {% for cve in cves %}
            <tr>
                <td><a href="/detail/?q={{cve.cve_id}}">{{cve.cve_id}}</a></td>
                <td>{{cve.cwe_id}}</td>
                <td>{{ cve.cvss_id}}</td>
                <td>
                    {% if cve.description %}
                    <p style="width: 550px;overflow: hidden;white-space: nowrap;text-overflow: ellipsis;">{{ cve.description}}</p>
                    {% else %}
                    <p style="color:red">Needed Complement</p>
                    {% endif %}
                </td>
                <td>{{ cve.exploits }}</td>
                <td>{{ cve.update_date }}</td>
                <td><a href="/Reward/incompleteList/cveAdd/?cveid={{cve.cve_id}}"><span class="glyphicon glyphicon-plus"></span></a></td>
            </tr>
            {%endfor%}
        </tbody>
        {%endif%}
    </table>
</div>
<nav class="text-center">
  <ul class="pagination pagination-sm">
    <li>
      <a href="/Reward/incompleteList/cves/?startIndex=0" aria-label="Previous">
        <span aria-hidden="true">&laquo;</span>
      </a>
    </li>   
    {%for pageNum in pageInfo.pages%}
        {%ifequal pageNum pageInfo.curPageNum%}
            <li class="active"><a href="/Reward/incompleteList/cves/?startIndex={{pageInfo.getPageIndex}}&firstPageNum={{pageInfo.firstPageNum}}">{{pageNum}}</a></li>
        {%else%}
            <li><a href="/Reward/incompleteList/cves/?startIndex={{pageInfo.getPageIndex}}&firstPageNum={{pageInfo.firstPageNum}}">{{pageNum}}</a></li>
        {%endifequal%}
    {%endfor%}
    <li>
      <a href="/Reward/incompleteList/cves/?startIndex={{pageInfo.lastPageIndex}}" aria-label="Next">
        <span aria-hidden="true">&raquo;</span>
      </a>
    </li>
  </ul>
</nav>
{% endblock %}