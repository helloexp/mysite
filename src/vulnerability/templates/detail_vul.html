{% extends "vulnerability.html" %}

{% block siderbar %}
list[0].classList.add('active')
{% endblock %} 

{% block vulneContent %}
<h2 class="page-header">漏洞信息列</h2>
<div class="hero-unit">
	<h1>漏洞：<strong>{{ query }}</strong></h1>
	<p>cveList: {{cves.cve_id}}</p>
	{% if cves %}
		<p><strong>基本信息</strong></p>
		<ul>
			{% for cve in cves %}
			<li>CWE：{{ cve.cwe_id }}</li>
			<li>漏洞类型：{{ cve.vuln_type }}</li>
			<li>CVSS：{{cve.cvss_id}}</li>
			<li>漏洞描述:{{ cve.description }}</li>
			<li>提交人:{{ cve.user }}</li>
			<li>更新时间:{{ cve.update_date }}</li>
			{% endfor %}
		</ul>
		
		{%if infos %}
			<p><strong>详细信息</strong></p>
			{% for info in infos %}
				<ul>
					<li>软件名:{{info.softeware}}</li>
					<li>描述区间:{{info.software_version}}</li>
					<li>包含漏洞版本列:{{info.contain_version}}</li>
					<li>选用版本:{{info.version_used}}</li>
					{% for file in files %}
						<li>漏洞文件:{{file}}</li>
					{%endfor%}
					{% for func in funcs %}
						<li>漏洞函数:{{func}}</li>
					{%endfor%}
					<li>主要修复文件:{{info.patch_file}}</li>
					<li>主要修复函数:{{info.patch_func}}</li>
					<li>已经修复漏洞版本列:{{info.reuse_version}}</li>
					<li>diff文件:{{info.diff_file}}</li>
					<li>diff链接:{{info.diff_link}}</li>
					<li>是否已经审核:{{info.check_flag}}</li>
				</ul>
			{%endfor%}
		{%endif%}
	{% else %}
		<p>{{errors}}</p>
	{% endif %} 
 </div>
{% endblock %} 
