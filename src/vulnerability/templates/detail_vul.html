{% extends "vulnerability.html" %}

{% block siderbar %}
list[0].classList.add('active')
{% endblock %} 

{% block vulneContent %}
<h2 class="page-header"></h2>
<div class="hero-unit">
	<h1>Vulnerability for：<strong>{{ query }}</strong></h1>
	<p>cveList: {{cves.cve_id}}</p>
	{% if cves %}
		<p><strong>Base Info:</strong></p>
		<ul>
			{% for cve in cves %}
			<li>CWE：{{ cve.cwe_id }}</li>
			<li>Type：{{ cve.vuln_type }}</li>
			<li>CVSS：{{cve.cvss_id}}</li>
			<li>Description:{{ cve.description }}</li>
			<li>Submitter:{{ cve.user }}</li>
			<li>Updatetime:{{ cve.update_date }}</li>
			{% endfor %}
		</ul>
		
		{%if infos %}
			<p><strong>More Information:</strong></p>
			{% for info in infos %}
				<ul>
					<li>Software:{{info.softeware}}</li>
					<li>Software Version:{{info.software_version}}</li>
					<li>Contained Version:{{info.contain_version}}</li>
					<li>Version:{{info.version_used}}</li>
					{% for file in files %}
						<li>vulnerability file:{{file}}</li>
					{%endfor%}
					{% for func in funcs %}
						<li>vulnerability function{{func}}</li>
					{%endfor%}
					<li>Patch File:{{info.patch_file}}</li>
					<li>Patch Function:{{info.patch_func}}</li>
					<li>Fixe Version:{{info.reuse_version}}</li>
					<li>Diff File:{{info.diff_file}}</li>
					<li>Diff Link:{{info.diff_link}}</li>
					<li>Is Checked:{{info.check_flag}}</li>
				</ul>
			{%endfor%}
		{%endif%}
	{% else %}
		<p>{{errors}}</p>
	{% endif %} 
 </div>
{% endblock %} 
