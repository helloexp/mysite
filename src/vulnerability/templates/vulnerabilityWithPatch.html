{% extends "vulnerability.html" %}

{% block siderbar %} 
list[1].classList.add('active')
{% endblock %} 

{% block vulneContent %}
<h2 class="page-header">Vulnerabilities With Patch List:</h2> {%if errors%} {%for error in errors%}
    <p style="color:red">{{error}}</p>
    {%endfor%} {%endif%}
    <p>There are <strong>{{pageInfo.sum}} </strong>Vulnerabilities records.</p>

    <div class="table-responsive">
        <table class="table table-striped">
        {%if vulnerabilities%}
            <thead>
                <tr>
                    <th style="width: 15%;">CVE</th>
                    <th style="width: 10%;">CWE</th>
                    <th style="width: 10%;">CVSS Severity</th>
                    <th style="width: 50%;">Summary</th>
                    <th style="width: 5%;">Exploits</th>
                    <th style="width: 10%;">UpdateTime</th>
                    <th>Edit</th>
                </tr>
            </thead>
            <tbody>
                 {% for vulnerability in vulnerabilities %}
                <tr>
                    <td><a href="/detail/?q={{vulnerability.cve_id}}" />{{ vulnerability.cve_id }}</td>
                    <td>{{vulnerability.cwe_id}}</td>
                    <td>{{ vulnerability.cvss_id}}</td>
                    <td>
                    <p style="width: 550px;overflow: hidden;white-space: nowrap;text-overflow: ellipsis;">{{ vulnerability.description }}</p>
                    </td>
                    <td>{{ vulnerability.exploits }}</td>
                    <td>{{ vulnerability.update_date }}</td>
                    <td><a href="/vulnerability/edit/?q={{vulnerability.cve_id}}" /><span class="glyphicon glyphicon-pencil"></span></td>
                </tr>
                {%endfor%}
            </tbody>
        {%endif%}
        </table>
    </div>
{% endblock %}