{% extends "vulnerability.html" %} {% block siderbar %} list[0].classList.add('active') {% endblock %} {% block vulneContent %}

<ul id="mytab" class="nav nav-tabs">
	<li class="active">
		<a href='#NVDVulnerabilities' data-toggle='tab'>NVD Vulnerabilities</a>
	</li>
	<li>
		<a href='#PatchVulnerabilities' data-toggle='tab'>Vulnerabilities with patch</a>
	</li>
	<li>
		<a href='#ReuseVulnerabilities' data-toggle='tab'>Vulnerabilities with reuse</a>
	</li>
</ul>
<div id="showVuln" class="tab-content">
	<div class="tab-pane fade in active" id="NVDVulnerabilities">
		<h2 class="page-header">Vulnerabilities List:</h2> {%if errors%} {%for error in errors%}
		<p style="color:red">{{error}}</p>
		{%endfor%} {%endif%}
		<p>There are <strong>{{pageInfoPatch.sum}} </strong>Vulnerabilities records.</p>
		<p>Displaying matches {{pageInfoPatch.curIndex}} through {{pageInfoPatch.endIndex}}.</p>

		<div class="table-responsive">
			<table class="table table-striped">
				<thead>
					<tr>
						<th style="width: 15%;">CVE</th>
						<th style="width: 10%;">CWE</th>
						<th style="width: 10%;">CVSS Severity</th>
						<th style="width: 50%;">Summary</th>
						<th style="width: 5%;">Exploits</th>
						<th style="width: 10%;">UpdateTime</th>
						<th>Edit</th>
					</tr>
				</thead>
				<tbody>
					{%if vulnerabilitiesWithPatch%} {% for vulnerability in vulnerabilitiesWithPatch %}
					<tr>
						<td><a href="/detail/?q={{vulnerability.cve_id}}" />{{ vulnerability.cve_id }}</td>
						<td>{{vulnerability.cwe_id}}</td>
						<td>{{ vulnerability.cvss_id}}</td>
						<td>
							<p style="width: 550px;overflow: hidden;white-space: nowrap;text-overflow: ellipsis;">{{ vulnerability.description }}</p>
						</td>
						<td>{{ vulnerability.exploits }}</td>
						<td>{{ vulnerability.update_date }}</td>
						<td><a href="/vulnerability/edit/?q={{vulnerability.cve_id}}" /><span class="glyphicon glyphicon-pencil"></span></td>
					</tr>
					{%endfor%} {%endif%}
				</tbody>
			</table>
		</div>
		<nav class="text-center">
			<ul class="pagination pagination-sm">
				<li>
					<a href="/NVDlist/?startIndex=0" aria-label="Previous">
						<span aria-hidden="true">&laquo;</span>
					</a>
				</li>
				{%for pageNum in pageInfoPatch.pages%} {%ifequal pageNum pageInfoPatch.curPageNum%}
				<li class="active"><a href="/NVDlist/?startIndex={{pageInfoPatch.getPageIndex}}&firstPageNum={{pageInfoPatch.firstPageNum}}">{{pageNum}}</a></li>
				{%else%}
				<li><a href="/NVDlist/?startIndex={{pageInfoPatch.getPageIndex}}&firstPageNum={{pageInfoPatch.firstPageNum}}">{{pageNum}}</a></li>
				{%endifequal%} {%endfor%}
				<li>
					<a href="/NVDlist/?startIndex={{pageInfoPatch.lastPageIndex}}" aria-label="Next">
						<span aria-hidden="true">&raquo;</span>
					</a>
				</li>
			</ul>
		</nav>
	</div>
	<div class="tab-pane fade" id="PatchVulnerabilities">
		<p>Vulnerabilities with patch info</p>
	</div>
	<div class="tab-pane fade" id="ReuseVulnerabilities">
		<p>Vulnerabilities with reuse info</p>
		<h2 class="page-header">Vulnerabilities List:</h2> {%if errors%} {%for error in errors%}
		<p style="color:red">{{error}}</p>
		{%endfor%} {%endif%}
		<p>There are <strong>{{pageInfoReuse.sum}} </strong>Vulnerabilities records.</p>
		<p>Displaying matches {{pageInfoReuse.curIndex}} through {{pageInfoReuse.endIndex}}.</p>

		<div class="table-responsive">
			<table class="table table-striped">
				<thead>
					<tr>
						<th style="width: 15%;">CVE</th>
						<th style="width: 10%;">CWE</th>
						<th style="width: 10%;">CVSS Severity</th>
						<th style="width: 50%;">Summary</th>
						<th style="width: 5%;">Exploits</th>
						<th style="width: 10%;">UpdateTime</th>
						<th>Edit</th>
					</tr>
				</thead>
				<tbody>
					{%if vulnerabilitiesWithReuse%} {% for vulnerability in vulnerabilitiesWithReuse %}
					<tr>
						<td><a href="/detail/?q={{vulnerability.cve_id}}" />{{ vulnerability.cve_id }}</td>
						<td>{{vulnerability.cwe_id}}</td>
						<td>{{ vulnerability.cvss_id}}</td>
						<td>
							<p style="width: 550px;overflow: hidden;white-space: nowrap;text-overflow: ellipsis;">{{ vulnerability.description }}</p>
						</td>
						<td>{{ vulnerability.exploits }}</td>
						<td>{{ vulnerability.update_date }}</td>
						<td><a href="/vulnerability/edit/?q={{vulnerability.cve_id}}" /><span class="glyphicon glyphicon-pencil"></span></td>
					</tr>
					{%endfor%} {%endif%}
				</tbody>
			</table>
		</div>
		<nav class="text-center">
			<ul class="pagination pagination-sm">
				<li>
					<a href="/Reuselist/?startIndex=0" aria-label="Previous">
						<span aria-hidden="true">&laquo;</span>
					</a>
				</li>
				{%for pageNum in pageInfoReuse.pages%} {%ifequal pageNum pageInfoReuse.curPageNum%}
				<li class="active"><a href="/Reuselist/?startIndex={{pageInfoReuse.getPageIndex}}&firstPageNum={{pageInfoReuse.firstPageNum}}">{{pageNum}}</a></li>
				{%else%}
				<li><a href="/Reuselist/?startIndex={{pageInfoReuse.getPageIndex}}&firstPageNum={{pageInfoReuse.firstPageNum}}">{{pageNum}}</a></li>
				{%endifequal%} {%endfor%}
				<li>
					<a href="/Reuselist/?startIndex={{pageInfoReuse.lastPageIndex}}" aria-label="Next">
						<span aria-hidden="true">&raquo;</span>
					</a>
				</li>
			</ul>
		</nav>
	</div>
</div>
<script type="text/javascript">
	var url = document.location.toString();
	document.write(url+ "<br />")
	document.write(url.match("Reuselist")+ "<br />")
	if (url.match("Reuselist")) {
		$('#mytab a[href = "#ReuseVulnerabilities"]').tab('show');
	}
	if (url.match("NVDlist")) {
		$('#mytab a[href = "#NVDVulnerabilities"]').tab('show');
	}
	if (url.match("Patchlist")) {
		$('#mytab a[href = "#PatchVulnerabilities"]').tab('show');
	}
	// Change hash for page-reload 
	$('#mytab a').on('shown', function(e) {
		window.location.hash = e.target.hash;
	});
//	$(function() {
//				$('#mytab a:first').tab('show'); //初始化显示哪个tab 
//				var url = document.location.toString();
//				document.write(url+ "<br />")
//				document.write(url.match("Reuselist")+ "<br />")
//				if (url.match("Reuselist")) {
//					$('#mytab a:last').tab('show');
//				}
//				$('#mytab a').click(function(e) {
//					$(this).tab('show'); //显示当前选中的链接及关联的content 
//				})
//			})
</script>
{% endblock %}