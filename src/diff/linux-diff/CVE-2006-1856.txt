diff --git a/fs/compat.c b/fs/compat.c
index
--- a/fs/compat.c
+++ b/fs/compat.c
@@ -1213,6 +1213,10 @@ static ssize_t compat_do_readv_writev(in
 	if (ret)
 		goto out;
 
+	ret = security_file_permission(file, type == READ ? MAY_READ:MAY_WRITE);
+	if (ret)
+		goto out;
+
 	fnv = NULL;
 	if (type == READ) {
 		fn = file->f_op->read;
diff --git a/fs/read_write.c b/fs/read_write.c
index
--- a/fs/read_write.c
+++ b/fs/read_write.c
@@ -455,6 +455,10 @@ static ssize_t do_readv_writev(int type,
 	if (ret)
 		goto out;
 
+	ret = security_file_permission(file, type == READ ? MAY_READ:MAY_WRITE);
+	if (ret)
+		goto out;
+
 	fnv = NULL;
 	if (type == READ) {
 		fn = file->f_op->read;