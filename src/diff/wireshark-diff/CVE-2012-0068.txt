diff --git a/wiretap/lanalyzer.c b/wiretap/lanalyzer.c
index
--- trunk/wiretap/lanalyzer.c	2011/12/13 01:49:27	40168
+++ trunk/wiretap/lanalyzer.c	2011/12/13 02:00:41	40169
@@ -467,6 +467,16 @@
 		return FALSE;
 	}
 	else {
+		if (record_length < DESCRIPTOR_LEN) {
+			/*
+			 * Uh-oh, the record isn't big enough to even have a
+			 * descriptor.
+			 */
+			*err = WTAP_ERR_BAD_RECORD;
+			*err_info = g_strdup_printf("lanalyzer: file has a %u-byte record, too small to have even a packet descriptor",
+			    record_length);
+			return FALSE;
+		}
 		packet_size = record_length - DESCRIPTOR_LEN;
 	}