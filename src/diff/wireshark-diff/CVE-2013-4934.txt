diff --git a/wiretap/netmon.c b/wiretap/netmon.c
index
--- trunk/wiretap/netmon.c	2013/06/02 18:01:14	49696
+++ trunk/wiretap/netmon.c	2013/06/02 18:09:13	49697
@@ -308,6 +308,15 @@
 	netmon->version_minor = hdr.ver_minor;
 
 	/*
+	 * No frame table allocated yet; initialize these in case we
+	 * get an error before allocating it or when trying to allocate
+	 * it, so that the attempt to release the private data on failure
+	 * doesn't crash.
+	 */
+	netmon->frame_table_size = 0;
+	netmon->frame_table = NULL;
+
+	/*
 	 * Get the offset of the frame index table.
 	 */
 	frame_table_offset = pletohl(&hdr.frametableoffset);