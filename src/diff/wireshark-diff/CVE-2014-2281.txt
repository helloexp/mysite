diff --git a/epan/dissectors/packet-nfs.c b/epan/dissectors/packet-nfs.c
index
--- trunk/epan/dissectors/packet-nfs.c	2014/01/21 09:56:34	54874
+++ trunk/epan/dissectors/packet-nfs.c	2014/01/21 18:48:01	54875
@@ -965,6 +965,13 @@
 	nfs_name_snoop_t *nns, *old_nns;
 	const char	 *ptr;
 
+	if (name_len <= 0) {
+		/* Do we need some way to signal an error here? This could be
+		 * programmatic or just a corrupt packet, depending on the
+		 * caller... */
+		return;
+	}
+
 	/* filter out all '.' and '..' names */
 	if (!name) {
 		ptr = (const char *)tvb_get_ptr(tvb, name_offset, name_len);
@@ -972,17 +979,17 @@
 		ptr = name;
 	}
 	if (ptr[0] == '.') {
-		if (ptr[1] == 0) {
+		if (name_len <= 1 || ptr[1] == 0) {
 			return;
 		}
 		if (ptr[1] == '.') {
-			if (ptr[2] == 0) {
+			if (name_len <= 2 || ptr[2] == 0) {
 				return;
 			}
 		}
 	}
 
-	nns = (nfs_name_snoop_t *)g_malloc(sizeof(nfs_name_snoop_t));
+	nns = g_new(nfs_name_snoop_t, 1);
 
 	nns->fh_length = 0;
 	nns->fh = NULL;